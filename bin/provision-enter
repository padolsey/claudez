#!/usr/bin/env bash
set -Eeuo pipefail
SELF_DIR="$(cd -- "$(dirname -- "${BASH_SOURCE[0]}")" && pwd)"
ROOT_DIR="$(cd "$SELF_DIR/.." && pwd)"
. "$ROOT_DIR/lib/common.sh"

NAME="${1:-}"; [ -z "$NAME" ] && die "Usage: provision enter <name>"
CONTAINER_NAME="${NAME}-app"

need docker

# Prefer launching/attaching Claude via the tmux-backed cc wrapper.
# IMPORTANT: Run as appuser so Claude finds /home/appuser/.claude.json
exec docker exec -it -u appuser "$CONTAINER_NAME" bash -lc 'command -v cc >/dev/null && cc || claude || bash'
